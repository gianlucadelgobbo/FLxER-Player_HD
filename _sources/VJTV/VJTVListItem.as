package VJTV {	import flash.display.Sprite;	import flash.display.Loader;	import flash.events.*;	import flash.net.URLRequest;	import FLxER.main.Rett;	import FLxER.main.Txt;	import FLxER.comp.ButtonTxt	import fl.transitions.*;	import fl.transitions.easing.*;	import flash.net.navigateToURL;	import flash.net.URLRequest;	public class VJTVListItem extends Sprite {		var myTweenOn:Tween;		var myTweenOff:Tween;		var w:uint;		public var tit,dat,dur,aut,txt,cat,tag,download		var fondino,imgLoader, fnz,fnzMore,fnzCanal,n,img,loadingProgress,myXml		public function VJTVListItem(xx,yy,ww,f,ff,fff):void {			fnz = f;			fnzMore = ff;			fnzCanal = fff;			y=yy;			x=xx;			w=ww;			trace(xx+" - "+yy)			fondino = new Rett(0, 0, ww, 100, 0x000000, -1, .5);			this.addChild(fondino);			tit = new Txt(135, 5, 310, 0, "", Preferences.pref.th, "");			tit.wordWrap = true;			//tit.scaleX=tit.scaleY = 2			this.addChild(tit);			dat = new Txt(137, 21, 225, 20, "", Preferences.pref.ts, "");			this.addChild(dat);			dat.alpha = .7;			dur = new Txt(388, 21, 100, 20, "", Preferences.pref.ts, "");			this.addChild(dur);			dur.addEventListener(TextEvent.LINK, linkEvent);			txt = new Txt(137, 54, 310, 40, "", Preferences.pref.ts, "");			txt.wordWrap = true;			this.addChild(txt);			this.img = new Sprite();			img.x=img.y=2;			this.addChild(img);			var fond = new Rett(0, 0, 128, 96, 0xCCCCCC, -1, .5);			img.addChild(fond);			this.imgLoader = new Loader();			imgLoader.contentLoaderInfo.addEventListener(Event.INIT, initHandlerSWF);			imgLoader.contentLoaderInfo.addEventListener(SecurityErrorEvent.SECURITY_ERROR, errorHandlerSWF);			imgLoader.contentLoaderInfo.addEventListener(IOErrorEvent.IO_ERROR, errorHandlerSWF);			img.addChild(imgLoader);			more = new ButtonTxt(140, 82, 35, 14, "INFO", showInfo, "", null);			//more.x = ww-2-more.width			this.addChild(more);			download = new ButtonTxt(140, 82, 76, 14, "DOWNLOAD", downloadFnz, "", null);			download.x = ww-2-download.width			this.addChild(download);		}		public function downloadFnz(a):void {			trace(downLink)			navigateToURL(new URLRequest(downLink));		}		public function showInfo(a):void {			fnzMore(myXml,n);		}		public function avviaOn(e) {			myTweenOn = new Tween(fondino,"alpha",Strong.easeIn,0,1,1,true);			myTweenOn.addEventListener(TweenEvent.MOTION_FINISH, avviaOff);		}		public function avviaOff(e) {			myTweenOff = new Tween(fondino,"alpha",Strong.easeOut,1,0,1,true);			myTweenOff.addEventListener(TweenEvent.MOTION_FINISH, avviaOn);		}		public function riempi(xml,nn):void {			n = nn;			myXml = xml;			if (myTweenOn) myTweenOn.stop(); 			if (myTweenOff) myTweenOff.stop(); 			fondino.alpha = 1;			if (myXml.childNodes[0].childNodes[0].toString() == Preferences.pref.currentMov){				avviaOff(null)			}			/*			var myDateA = myXml.childNodes[1].childNodes[1].nodeValue.split(",");			var myDate = new Date(myDateA[0],myDateA[1],myDateA[2],myDateA[3],myDateA[4],myDateA[5]);			trace("dat "+myDate.getFullYear()+"-"+putZero(myDate.getMonth()+1)+"-"+putZero(myDate.getDate())+" "+putZero(myDate.getHours())+":"+putZero(myDate.getMinutes()));			dat.htmlText = myDate.getFullYear()+"-"+putZero(myDate.getMonth()+1)+"-"+putZero(myDate.getDate())+" "+putZero(myDate.getHours())+":"+putZero(myDate.getMinutes());			*/			/*			trace("flv "+myXml.childNodes[0].childNodes[0].toString())			trace("currentMov "+Preferences.pref.currentMov)			trace("img "+myXml.childNodes[2].childNodes[0])			trace("tit "+myXml.childNodes[1].childNodes[0])			trace("dat "+myXml.childNodes[1].childNodes[1].childNodes[0]);			trace("info "+myXml.childNodes[1].childNodes[2].childNodes[0]);			trace("txt "+myXml.childNodes[1].childNodes[3].childNodes[0])			trace("InfoFull "+myXml.childNodes[1].childNodes[4].childNodes[0])			trace("cat "+myXml.childNodes[1].childNodes[5].childNodes[0])			trace("dow "+myXml.childNodes[1].childNodes[6].childNodes[0])			*/			//if (myXml.childNodes[1].childNodes[0]) tit.htmlText = myXml.childNodes[1].childNodes[0].childNodes[0].toString();			//if (myXml.childNodes[1].childNodes[2]) dat.htmlText = myXml.childNodes[1].childNodes[2].childNodes[0].toString();			dur.htmlText = Preferences.myReplace(myXml.childNodes[1].childNodes[5].childNodes[0].toString(),"href=\"","href=\"event:");			txt.htmlText = myXml.childNodes[1].childNodes[3].childNodes[0].toString();			if (myXml.childNodes[1].childNodes>5) downLink = myXml.childNodes[1].childNodes[6].childNodes[0]			downLink = false			if (downLink) {				download.visible = true			} else {				download.visible = false			}			trace(dur.htmlText)			//dur.htmlText = Preferences.pref.interfaceTrgt.myToolbar.myTime(int(parseInt(myXml.childNodes[1].childNodes[2].childNodes[0])/1000));			setPos();			imgLoader.load(new URLRequest(myXml.childNodes[2].childNodes[0].toString()));			loadingProgress = true;			//tag.htmlText = myXml.childNodes[3].childNodes[0];		}		public function linkEvent(event:TextEvent):void {			fnzCanal(event.text); // Link Clicked		}		public function setPos():void {			if (imgLoader.width) {				imgLoader.width = 128;				imgLoader.scaleY = imgLoader.scaleX 			}			tit.height = tit.textHeight + 4;			dat.y = dur.y = tit.height+(tit.height > 40 ? -5 : 0);			txt.y = dat.y+20;			txt.height = 100-txt.y - 25			dur.x = w-12-dur.textWidth		}		public function svuota():void {			if (myTweenOn) myTweenOn.stop(); 			if (myTweenOff) myTweenOff.stop(); 			fondino.alpha = 1;			tit.htmlText = dat.htmlText = txt.htmlText = dur.htmlText = "";			if (loadingProgress) {				imgLoader.close();			} else {				imgLoader.unload();			}		}		private function putZero(str):String {			return (str.toString().length < 2 ? "0"+str : str);		}		private function mouseDownHandler(event:Event):void {			fnz(n);		}		private function mouseOverHandler(event:Event):void {			img.alpha = .5;		}		private function mouseOutHandler(event:Event):void {			img.alpha = 1;		}		private function initHandlerSWF(event:Event):void {			setPos();			loadingProgress = false;			enable()		}		private function errorHandlerSWF(event:Event):void {			trace("error "+event)		}		public function enable() {			img.mouseChildren = false;			img.addEventListener(MouseEvent.MOUSE_DOWN,mouseDownHandler);			img.addEventListener(MouseEvent.MOUSE_OVER,mouseOverHandler);			img.addEventListener(MouseEvent.MOUSE_OUT,mouseOutHandler);			img.buttonMode=true;		}		public function disable() {			img.removeEventListener(MouseEvent.MOUSE_DOWN,mouseDownHandler);			img.removeEventListener(MouseEvent.MOUSE_OVER,mouseOverHandler);			img.removeEventListener(MouseEvent.MOUSE_OUT,mouseOutHandler);			img.buttonMode=false;			mouseOutHandler(null);		}	}}